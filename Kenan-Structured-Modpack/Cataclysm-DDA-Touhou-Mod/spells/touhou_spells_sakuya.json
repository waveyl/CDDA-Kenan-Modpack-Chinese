[
  {
    "id": "sakuya_contraction",
    "type": "SPELL",
    "name": "Time manipulation (Temporal contraction)",
    "description": "Reduce the flow of time inside the affected area.",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "field", "ground", "hostile", "item" ],
    "affected_body_parts": [ "arm_l", "arm_r", "eyes", "foot_l", "foot_r", "hand_l", "hand_r", "head", "leg_l", "leg_r", "mouth", "torso" ],
    "effect": "attack",
    "effect_str": "sakuya_contraction_effect",
    "shape": "blast",
    "damage_type": "bash",
    "min_range": { "math": [ "( (u_skill('throw') * 0.55 ) + (u_skill('dodge') * 0.55 ) + 1.15 )" ] },
    "max_range": 16,
    "min_aoe": { "math": [ "( (u_skill('throw') * 0.25 ) + (u_skill('dodge') * 0.25 ) + 2.25 )" ] },
    "max_aoe": 9,
    "min_duration": { "math": [ "( (u_skill('throw') * 120 ) + (u_skill('dodge') * 120 ) + 360 )" ] },
    "max_duration": 3600,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 100,
    "base_energy_cost": 133,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_PROJECTILE", "SILENT" ],
    "//": "min range 5, min aoe 4, min dur 1200"
  },
  {
    "id": "sakuya_dilation",
    "type": "SPELL",
    "name": "Time manipulation (Temporal dilation)",
    "description": "Dilate time around your personal bubble, increasing your movement speed.",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "attack",
    "effect_str": "sakuya_dilation_effect",
    "shape": "blast",
    "min_aoe": 2,
    "max_aoe": 2,
    "min_duration": { "math": [ "( (u_skill('throw') * 1200 ) + (u_skill('dodge') * 1200 ) - 2400 )" ] },
    "max_duration": 30000,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 200,
    "base_energy_cost": 133,
    "energy_source": "MANA",
    "flags": [ "IGNORE_WALLS", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE", "VERBAL" ],
    "//": "min dur 6000"
  },
  {
    "id": "sakuya_dismiss_knives",
    "type": "SPELL",
    "name": "Dismiss knives",
    "description": "Restore the time flow around frozen knives, removing them.",
    "spell_class": "NONE",
    "valid_targets": [ "field", "ground", "item", "self" ],
    "effect": "ter_transform",
    "effect_str": "freezeknife_dismiss_ter",
    "shape": "blast",
    "min_aoe": 32,
    "max_aoe": 32,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 100,
    "base_energy_cost": 33,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE", "SILENT", "SOMATIC" ]
  },
  {
    "id": "sakuya_freezeknife",
    "type": "SPELL",
    "name": "Freeze knife",
    "description": "Throw a knife and freeze it in space and time, allowing its use as solid platform.  \nWarning: this permanently consumes the item.",
    "spell_class": "NONE",
    "valid_targets": [ "ground" ],
    "components": "spell_components_knives",
    "effect": "ter_transform",
    "effect_str": "freezeknife_ter",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_range": 12,
    "max_range": 12,
    "min_duration": 6000,
    "max_duration": 6000,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 66,
    "base_energy_cost": 33,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "SOMATIC" ],
    "//note": "This should also be castable on solid terrain, spawning a furniture that can be used to climb up. The problem is that by using the same flags as keystone_crash_fur it will destroy any existing furniture beneath, instead of just removing the knife and leaving the previous furniture"
  },
  {
    "id": "sakuya_jackknife",
    "type": "SPELL",
    "name": "Jack the Knife",
    "description": "Borrow a silver knife from parallel records for a short time.  As the knife goes away on its own after a while, it is somewhat like recycling.",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "spawn_item",
    "effect_str": "silver_knife",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_duration": { "math": [ "( (u_skill('throw') * 15 ) + (u_skill('stabbing') * 15 ) + 780 )" ] },
    "max_duration": 1200,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 66,
    "base_energy_cost": 66,
    "energy_source": "MANA",
    "flags": [ "NO_LEGS", "SILENT" ],
    "//": "Changing the silver_knife type to AMMO and setting a count of 3 doesn't enable spawning more than one knife, not even by casting the spell twice + using the NO_HANDS flag: the second knife automatically spawns on the ground",
    "//2": "min dur 900"
  },
  {
    "id": "sakuya_maidsecret",
    "type": "SPELL",
    "name": "Maid's secret",
    "description": "Employ your secret technique to keep the Mansion clean all the time, increasing your momentum and recovery rate.  Your concentration will be broken if you get tired, or by enemies getting close.  Cast again to toggle OFF.",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "sakuya_maidsecret_eoc",
    "extra_effects": [ { "id": "sakuya_maidsecret2" } ],
    "shape": "blast",
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 100,
    "base_energy_cost": 50,
    "energy_source": "MANA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "IGNORE_WALLS", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "aoe is 14 - 6, scaling down with skills (see below for the formula)",
    "//2": "This should also break after attacking or being attacked, but currently there seems no way to check either"
  },
  {
    "id": "sakuya_maidsecret2",
    "type": "SPELL",
    "name": "Maid's secret (vfx)",
    "description": "Visual effect for the aoe, so the player is aware of the effect boundary",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "self" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "pure",
    "min_aoe": { "math": [ "( - (u_skill('stabbing') * 0.4 ) - (u_skill('dodge') * 0.4 ) + 16.8 )" ] },
    "max_aoe": 14,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "IGNORE_WALLS", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ]
  },
  {
    "id": "sakuya_quickrest",
    "type": "SPELL",
    "name": "Time manipulation (Quick rest)",
    "description": "Capture a temporal snapshot of yourself, enabling yourself to rest for a while, and delete it afterwards as if nothing happened.",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "attack",
    "effect_str": "sakuya_quickrest_effect",
    "shape": "blast",
    "min_duration": 100,
    "max_duration": 100,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 50,
    "base_energy_cost": 200,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE", "SILENT" ],
    "//": "The effects cannot scale with the math field..."
  },
  {
    "id": "sakuya_timeparadox",
    "type": "SPELL",
    "name": { "str": "Time paradox" },
    "description": "Tamper with the local timeline to summon a parallel \"you\" for a short time.",
    "spell_class": "NONE",
    "valid_targets": [ "ground" ],
    "effect": "summon",
    "effect_str": "mon_sakuya_alternate",
    "shape": "blast",
    "min_damage": 1,
    "max_damage": 1,
    "min_aoe": 3,
    "max_aoe": 3,
    "min_duration": { "math": [ "( (u_skill('throw') * 35 ) + (u_skill('stabbing') * 35 ) + 620 )" ] },
    "max_duration": 1600,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 33,
    "base_energy_cost": 166,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "SILENT", "SOMATIC" ],
    "//": "min dur 900"
  },
  {
    "id": "sakuya_timestop",
    "type": "SPELL",
    "name": "Time manipulation (Time stop)",
    "description": "Stop time around yourself.",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "mod_moves",
    "extra_effects": [ { "id": "sakuya_timestop_vfx" } ],
    "shape": "blast",
    "damage_type": "pure",
    "min_damage": { "math": [ "( (u_skill('throw') * 35 ) + (u_skill('stabbing') * 35 ) + (u_skill('dodge') * 70 ) + 210 )" ] },
    "max_damage": 2100,
    "min_aoe": 1,
    "max_aoe": 1,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 33,
    "base_energy_cost": 166,
    "energy_source": "MANA",
    "flags": [ "IGNORE_WALLS", "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE", "SILENT" ],
    "//": "min dur 700"
  },
  {
    "id": "sakuya_timestop_vfx",
    "type": "SPELL",
    "name": "Time manipulation (Time stop) (vfx)",
    "description": "Visual effect for sakuya_timestop , so the player is aware the timestop effect is active",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "self" ],
    "effect": "attack",
    "effect_str": "sakuya_timestop_effect",
    "shape": "blast",
    "damage_type": "pure",
    "min_aoe": 6,
    "max_aoe": 6,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "IGNORE_WALLS", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "Definitely should invert colors under the aoe"
  },
  {
    "id": "sakuya_vanishingeverything",
    "type": "SPELL",
    "name": { "str": "Vanishing everything" },
    "description": "Manipulate spacetime, teleporting a short distance.  Cast again in the next 3 s to teleport back.",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "sakuya_vanishingeverything_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 133,
    "energy_source": "MANA",
    "flags": [ "NO_HANDS", "NO_LEGS", "SOMATIC" ]
  },
  {
    "id": "sakuya_vanishingeverything2",
    "type": "SPELL",
    "name": { "str": "Vanishing everything" },
    "description": "Manipulate spacetime, teleporting a short distance.  Cast again in the next 3 s to teleport back.",
    "spell_class": "NONE",
    "valid_targets": [ "ground" ],
    "effect": "short_range_teleport",
    "shape": "line",
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS", "NO_PROJECTILE", "TARGET_TELEPORT" ]
  }
]
